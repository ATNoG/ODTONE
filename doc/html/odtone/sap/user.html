<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Class user</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="../../index.html" title="ODTONE 0.4">
<link rel="up" href="../../odtone_sap_library.html#header..home.carlos.Projectos.odtone.inc.odtone.sap.user_hpp" title="Header &lt;/home/carlos/Projectos/odtone/inc/odtone/sap/user.hpp&gt;">
<link rel="prev" href="sap.html" title="Class sap">
<link rel="next" href="user/config.html" title="Struct config">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="'ODTONE - Open Dot Twenty One'" width="100" height="100" src="../.././images/logo.png"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="sap.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../odtone_sap_library.html#header..home.carlos.Projectos.odtone.inc.odtone.sap.user_hpp"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="user/config.html"><img src="../../images/next.png" alt="Next"></a>
</div>
<div class="refentry">
<a name="odtone.sap.user"></a><div class="titlepage"></div>
<div class="refnamediv">
<h2><span class="refentrytitle">Class user</span></h2>
<p>odtone::sap::user</p>
</div>
<h2 xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="refsynopsisdiv-title">Synopsis</h2>
<div xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="refsynopsisdiv"><pre class="synopsis"><span class="comment">// In header: &lt;<a class="link" href="../../odtone_sap_library.html#header..home.carlos.Projectos.odtone.inc.odtone.sap.user_hpp" title="Header &lt;/home/carlos/Projectos/odtone/inc/odtone/sap/user.hpp&gt;">/home/carlos/Projectos/odtone/inc/odtone/sap/user.hpp</a>&gt;

</span>
<span class="keyword">class</span> <a class="link" href="user.html" title="Class user">user</a> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">odtone</span><span class="special">::</span><span class="identifier">sap</span><span class="special">::</span><span class="identifier">sap</span> <span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
  <span class="comment">// member classes/structs/unions</span>

  <span class="keyword">struct</span> <a class="link" href="user/config.html" title="Struct config">config</a> <span class="special">{</span>
    <span class="comment">// <a class="link" href="user/config.html#odtone.sap.user.configconstruct-copy-destruct">construct/copy/destruct</a></span>
    <a class="link" href="user/config.html#idp1524616-bb"><span class="identifier">config</span></a><span class="special">(</span><span class="special">)</span><span class="special">;</span>

    <span class="comment">// <a class="link" href="user/config.html#odtone.sap.user.configpublic-data-members">public data members</a></span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <a class="link" href="user/config.html#odtone.sap.user.config.id"><span class="identifier">id</span></a><span class="special">;</span>
    <span class="identifier">uint</span> <a class="link" href="user/config.html#odtone.sap.user.config.port"><span class="identifier">port</span></a><span class="special">;</span>
    <span class="identifier">ip_address</span> <a class="link" href="user/config.html#odtone.sap.user.config.mihf_address"><span class="identifier">mihf_address</span></a><span class="special">;</span>
    <span class="identifier">uint</span> <a class="link" href="user/config.html#odtone.sap.user.config.mihf_port"><span class="identifier">mihf_port</span></a><span class="special">;</span>
    <span class="identifier">size_t</span> <a class="link" href="user/config.html#odtone.sap.user.config.buffer_length"><span class="identifier">buffer_length</span></a><span class="special">;</span>
  <span class="special">}</span><span class="special">;</span>
  <span class="comment">// <a class="link" href="user.html#odtone.sap.userconstruct-copy-destruct">construct/copy/destruct</a></span>
  <a class="link" href="user.html#idp1452512-bb"><span class="identifier">user</span></a><span class="special">(</span><span class="keyword">const</span> <span class="identifier">mih</span><span class="special">::</span><span class="identifier">config</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">asio</span><span class="special">::</span><span class="identifier">io_service</span> <span class="special">&amp;</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">handler</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
  <a class="link" href="user.html#idp1454912-bb"><span class="identifier">user</span></a><span class="special">(</span><span class="identifier">boost</span><span class="special">::</span><span class="identifier">asio</span><span class="special">::</span><span class="identifier">io_service</span> <span class="special">&amp;</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">handler</span> <span class="special">&amp;</span><span class="special">,</span> <span class="keyword">const</span> <a class="link" href="user/config.html" title="Struct config">config</a> <span class="special">&amp;</span> <span class="special">=</span> <a class="link" href="user/config.html" title="Struct config">config</a><span class="special">(</span><span class="special">)</span><span class="special">)</span><span class="special">;</span>
  <a class="link" href="user.html#idp5086824-bb"><span class="special">~</span><span class="identifier">user</span></a><span class="special">(</span><span class="special">)</span><span class="special">;</span>

  <span class="comment">// <a class="link" href="user.html#idp1524680-bb">public member functions</a></span>
  <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> CompletionHandler<span class="special">&gt;</span> 
    <span class="keyword">void</span> <a class="link" href="user.html#idp1524864-bb"><span class="identifier">async_send</span></a><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">message</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">CompletionHandler</span><span class="special">)</span><span class="special">;</span>

  <span class="comment">// <a class="link" href="user.html#idp5087080-bb">private member functions</a></span>
  <span class="keyword">void</span> <a class="link" href="user.html#idp5087264-bb"><span class="identifier">async_send_</span></a><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">message</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;&amp;</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">void</span> <a class="link" href="user.html#idp5089384-bb"><span class="identifier">recv_handler</span></a><span class="special">(</span><span class="identifier">buffer</span><span class="special">&lt;</span> <span class="identifier">uint8</span> <span class="special">&gt;</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">size_t</span><span class="special">,</span> 
                    <span class="keyword">const</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">system</span><span class="special">::</span><span class="identifier">error_code</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">void</span> <a class="link" href="user.html#idp5092056-bb"><span class="identifier">send_handler</span></a><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">frame_vla</span> <span class="special">&amp;</span><span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;</span><span class="special">,</span> 
                    <span class="keyword">const</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">system</span><span class="special">::</span><span class="identifier">error_code</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
  <span class="keyword">void</span> <a class="link" href="user.html#idp5146248-bb"><span class="identifier">get_handler</span></a><span class="special">(</span><span class="identifier">uint</span><span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;</span><span class="special">)</span><span class="special">;</span>
<span class="special">}</span><span class="special">;</span></pre></div>
<div class="refsect1">
<a name="idp18950216"></a><h2>Description</h2>
<p>MIH-User SAP I/O Service</p>
<p>This module handles the comunication between MIH-User SAP and its local the MIHF. After being initialized, and in order to run this service, it must be invoked the run() method of the boost::asio::io_service associated. </p>
<div class="refsect2">
<a name="idp18950944"></a><h3>
<a name="odtone.sap.userconstruct-copy-destruct"></a><code class="computeroutput">user</code> 
        public
       construct/copy/destruct</h3>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<pre class="literallayout"><a name="idp1452512-bb"></a><span class="identifier">user</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">mih</span><span class="special">::</span><span class="identifier">config</span> <span class="special">&amp;</span> cfg<span class="special">,</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">asio</span><span class="special">::</span><span class="identifier">io_service</span> <span class="special">&amp;</span> io<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">handler</span> <span class="special">&amp;</span> h<span class="special">)</span><span class="special">;</span></pre>
<p>Construct a MIH-User SAP I/O Service. The defined callback is invoked when a request message is received The signature of the callback is: void(odtone::mih::message&amp;, const boost::system::error_code&amp;).</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">cfg</code></span></p></td>
<td><p>Configuration parameters. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Message processing handler. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">io</code></span></p></td>
<td><p>The io_service object that Link SAP I/O Service will use to dispatch handlers for any asynchronous operations performed on the socket. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><a name="idp1454912-bb"></a><span class="identifier">user</span><span class="special">(</span><span class="identifier">boost</span><span class="special">::</span><span class="identifier">asio</span><span class="special">::</span><span class="identifier">io_service</span> <span class="special">&amp;</span> io<span class="special">,</span> <span class="keyword">const</span> <span class="identifier">handler</span> <span class="special">&amp;</span> h<span class="special">,</span> 
     <span class="keyword">const</span> <a class="link" href="user/config.html" title="Struct config">config</a> <span class="special">&amp;</span> cfg <span class="special">=</span> <a class="link" href="user/config.html" title="Struct config">config</a><span class="special">(</span><span class="special">)</span><span class="special">)</span><span class="special">;</span></pre>
<p>Construct a MIH-User SAP I/O Service. The defined callback is invoked when a request message is received The signature of the callback is: void(odtone::mih::message&amp;, const boost::system::error_code&amp;).</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">cfg</code></span></p></td>
<td><p>Configuration parameters. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Message processing handler. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">io</code></span></p></td>
<td><p>The io_service object that Link SAP I/O Service will use to dispatch handlers for any asynchronous operations performed on the socket. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><a name="idp5086824-bb"></a><span class="special">~</span><span class="identifier">user</span><span class="special">(</span><span class="special">)</span><span class="special">;</span></pre>
<p>Destruct a MIH-User SAP I/O Service. </p>
</li>
</ol></div>
</div>
<div class="refsect2">
<a name="idp18975784"></a><h3>
<a name="idp1524680-bb"></a><code class="computeroutput">user</code> public member functions</h3>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
<pre class="literallayout"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">typename</span> CompletionHandler<span class="special">&gt;</span> 
  <span class="keyword">void</span> <a name="idp1524864-bb"></a><span class="identifier">async_send</span><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">message</span> <span class="special">&amp;</span> pm<span class="special">,</span> <span class="identifier">CompletionHandler</span> h<span class="special">)</span><span class="special">;</span></pre>
<p>Asynchronously send a MIH message to the local MIHF. After sending the message, the callback is called to report the success or failure in delivering the message to the local MIHF. This method retuns immediately.</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Response handler function. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">pm</code></span></p></td>
<td><p>MIH message to send. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li></ol></div>
</div>
<div class="refsect2">
<a name="idp18984896"></a><h3>
<a name="idp5087080-bb"></a><code class="computeroutput">user</code> private member functions</h3>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<pre class="literallayout"><span class="keyword">void</span> <a name="idp5087264-bb"></a><span class="identifier">async_send_</span><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">message</span> <span class="special">&amp;</span> msg<span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;&amp;</span> h<span class="special">)</span><span class="special">;</span></pre>
<p>Asynchronously send a MIH message to the local MIHF. After sending the message, the callback is called to report the success or failure in delivering the message to the local MIHF. This method retuns immediately.</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Response handler function. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">msg</code></span></p></td>
<td><p>MIH message to send. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">void</span> <a name="idp5089384-bb"></a><span class="identifier">recv_handler</span><span class="special">(</span><span class="identifier">buffer</span><span class="special">&lt;</span> <span class="identifier">uint8</span> <span class="special">&gt;</span> <span class="special">&amp;</span> buff<span class="special">,</span> <span class="identifier">size_t</span> rbytes<span class="special">,</span> 
                  <span class="keyword">const</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">system</span><span class="special">::</span><span class="identifier">error_code</span> <span class="special">&amp;</span> ec<span class="special">)</span><span class="special">;</span></pre>
<p>Received message callback. This function is executed to process the received messages. If this is a valid message, the message is dispatched to the handler defined by the user.</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">buff</code></span></p></td>
<td><p>Message byte buffer. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">ec</code></span></p></td>
<td><p>Error code. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">rbytes</code></span></p></td>
<td><p>Size of the message. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">void</span> <a name="idp5092056-bb"></a><span class="identifier">send_handler</span><span class="special">(</span><span class="identifier">mih</span><span class="special">::</span><span class="identifier">frame_vla</span> <span class="special">&amp;</span> fm<span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;</span> h<span class="special">,</span> 
                  <span class="keyword">const</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">system</span><span class="special">::</span><span class="identifier">error_code</span> <span class="special">&amp;</span> ec<span class="special">)</span><span class="special">;</span></pre>
<p>Sent message handler. After sending the message, this function is called to report the success or failure in delivering the message to the local MIHF.</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">ec</code></span></p></td>
<td><p>Error code. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">fm</code></span></p></td>
<td><p>MIH message sent. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Message handler. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
<li class="listitem">
<pre class="literallayout"><span class="keyword">void</span> <a name="idp5146248-bb"></a><span class="identifier">get_handler</span><span class="special">(</span><span class="identifier">uint</span> tid<span class="special">,</span> <span class="identifier">handler</span> <span class="special">&amp;</span> h<span class="special">)</span><span class="special">;</span></pre>
<p>Get the message handler function of the message.</p>
<p>
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term">Parameters:</span></p></td>
<td><div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><code class="computeroutput">h</code></span></p></td>
<td><p>Reference to the message handler. </p></td>
</tr>
<tr>
<td><p><span class="term"><code class="computeroutput">tid</code></span></p></td>
<td><p>Transaction ID of the message. </p></td>
</tr>
</tbody>
</table></div></td>
</tr></tbody>
</table></div>
</li>
</ol></div>
</div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2009-2012 Universidade
      Aveiro<br>Copyright &#169; 2009-2012 Instituto
      de Telecomunica&#231;&#245;es - P&#243;lo Aveiro<p>
        This software is distributed under a license. The full license agreement
        can be found in the LICENSE in this distribution. This software may not be
        copied, modified, sold or distributed other than expressed in the named license
        agreement. This software is distributed without any warranty.
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="sap.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../odtone_sap_library.html#header..home.carlos.Projectos.odtone.inc.odtone.sap.user_hpp"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="user/config.html"><img src="../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
